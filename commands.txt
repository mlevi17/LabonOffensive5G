VM
vagrant provision victim
vagrant ssh victim


DNS
cat /etc/resolv.conf
systemctl status dnsmasq
sudo systemctl restart dnsmasq


Webserver
systemctl status nginx
sudo systemctl restart nginx
sudo nginx -t
curl http://secure-login.com
curl http://unsecure-login.com/submit?data=pwd-123

sudo openssl genrsa -out /etc/ssl/private/secure-login.key 2048
sudo openssl req -new -x509 \
  -key /etc/ssl/private/secure-login.key \
  -out /etc/ssl/certs/secure-login.crt \
  -days 365

 curl -k -L http://secure-login.com
 curl -k -L "http://secure-login.com/submit?password=SECRET123"

sudo tail -f /var/log/nginx/access.log
ps -p $(ps -o ppid= -p $$) -o comm=

Attack
sudo python3 /opt/tools/attack.py



        """# Check for HTTP packets from victim
        elif packet.haslayer(scapy.TCP) and packet[scapy.TCP].dport == 80:
            dst = packet[scapy.IP].dst
            msg = f"[HTTP] {victim_ip} -> {dst}:80"
            payload = None
            
            # Extract HTTP payload
            if packet.haslayer(scapy.Raw):
                    payload = packet[scapy.Raw].load.decode('utf-8', errors='ignore').rstrip("\n")
            
            log_packet(msg, payload)
        
        # Check for HTTPS packets from victim
        elif packet.haslayer(scapy.TCP) and packet[scapy.TCP].dport == 443:
            dst = packet[scapy.IP].dst           
            log_packet(f"[HTTPS] {victim_ip} -> {dst}:443")"""